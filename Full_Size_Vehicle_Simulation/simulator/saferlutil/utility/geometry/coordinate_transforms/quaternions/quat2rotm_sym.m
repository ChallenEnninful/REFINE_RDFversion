function R = quat2rotm_sym(q)
    q0 = q(1) ; q1 = q(2) ; q2 = q(3) ; q3 = q(4) ;
    
    R11 = 1 - 2*q2^2 - 2*q3^2 ;
    R12 = 2*(q1*q2 + q0*q3) ;
    R13 = 2*(q1*q3 - q0*q2) ;
    
    R21 = 2*(q1*q2 - q0*q3) ;
    R22 = 1 - 2*q1^2 - 2*q3^2 ;
    R23 = 2*(q2*q3 + q0*q1) ;
    
    R31 = 2*(q1*q3 + q0*q2) ;
    R32 = 2*(q2*q3 - q0*q1) ;
    R33 = 1 - 2*q1^2 - 2*q2^2 ;
    
    R = [R11 R12 R13 ;
         R21 R22 R23 ;
         R31 R32 R33] ;
end